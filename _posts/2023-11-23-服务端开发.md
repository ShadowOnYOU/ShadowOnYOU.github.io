---
layout: post
title: 服务端开发
categories: [cate1, cate2]
description: some word here
keywords: keyword1, keyword2
mermaid: false
sequence: false
flow: false
mathjax: false
mindmap: false
mindmap2: false
---

# 服务端开发——spring intergration

## 1. 复习

消息中间件主要解决生产消费者彼此不需要知道的情况

### JMS

![截屏2023-11-23 下午6.41.57](https://github.com/ShadowOnYOU/images/blob/main/test202311231842626.png?raw=true)

### 关键概念

ConnectionFactory，Connection，Session，Desitination

### 消息转换器

序列化与反序列化

这边可以使用不同的消息转换器（常用MappingJackson2MessageConverter）

typeid：告诉对方java对象的名称

### 拉取 && 推送

JMS中没有routing key这个概念



JMS和RabbitMQ（多了一个路由的能力）对应起来整理

## 2. spring integration

EIP：企业集成模式

## 3. 一个简单的集成流（Integration flow）

![截屏2023-11-23 下午6.59.33](https://github.com/ShadowOnYOU/images/blob/main/test202311231859588.png?raw=true)

记住这些关键词就可以了

adapter：与外部系统的交接（连接到其他系统）

通过流，流到文件系统里

### gateway:

其实就是一个接口（被谁调用：）（你只管定义，具体的内容spring帮你实现）

![截屏2023-11-23 下午7.06.36](https://github.com/ShadowOnYOU/images/blob/main/test202311231906756.png?raw=true)

会流到哪个channel里（指定消息的入口）。

参数：FILENAME（key）filename（value）

需要添加的依赖：spring boot starter integration；spring integration file![截屏2023-11-23 下午7.06.10](https://github.com/ShadowOnYOU/images/blob/main/test202311231906878.png?raw=true)

### transformer

消息从input管道传递到output管道

![截屏2023-11-23 下午7.14.34](https://github.com/ShadowOnYOU/images/blob/main/test202311231914720.png?raw=true)

![截屏2023-11-23 下午7.13.49](https://github.com/ShadowOnYOU/images/blob/main/test202311231913302.png?raw=true)

### adapter

把消息扔到系统之外

![截屏2023-11-23 下午7.15.59](https://github.com/ShadowOnYOU/images/blob/main/test202311231916560.png?raw=true)

添加到文件尾部

## 3. 集成流的配置

1. xml配置

定义一个接口：网关（见上）

定义一个流：

![截屏2023-11-23 下午7.20.59](https://github.com/ShadowOnYOU/images/blob/main/test202311231921638.png?raw=true)

int：integration![截屏2023-11-23 下午7.24.42](https://github.com/ShadowOnYOU/images/blob/main/test202311231924049.png?raw=true)



1. java配置
2. 使用DSL的java配置

一个bean就秒啦

![截屏2023-11-23 下午7.38.38](https://github.com/ShadowOnYOU/images/blob/main/test202311231938443.png?raw=true)

## 4. 集成流的组件

![截屏2023-11-23 下午7.45.20](https://github.com/ShadowOnYOU/images/blob/main/test202311231945076.png?raw=true)

### 消息通道（类别）

![截屏2023-11-23 下午7.51.08](https://github.com/ShadowOnYOU/images/blob/main/test202311231951759.png?raw=true)

了解即可。

### 过滤器

![截屏2023-11-23 下午7.52.33](https://github.com/ShadowOnYOU/images/blob/main/test202311231952898.png?raw=true)

通过一个函数。若返回true，进入下一个，若为false，到此为止了

### 转换器

![截屏2023-11-23 下午7.54.27](https://github.com/ShadowOnYOU/images/blob/main/test202311231954584.png?raw=true)

进来的类型和出去的类型没有直接的联系（可同可不同）。

### 路由器

![截屏2023-11-23 下午7.55.49](https://github.com/ShadowOnYOU/images/blob/main/test202311231955795.png?raw=true)

### 切分器

![截屏2023-11-23 下午7.59.07](https://github.com/ShadowOnYOU/images/blob/main/test202311231959720.png?raw=true)

### 服务激活器

![截屏2023-11-23 下午8.05.59](https://github.com/ShadowOnYOU/images/blob/main/test202311232006039.png?raw=true)

### 网关

![截屏2023-11-23 下午8.11.21](https://github.com/ShadowOnYOU/images/blob/main/test202311232011511.png?raw=true)

### 通道适配器

![截屏2023-11-23 下午8.15.52](https://github.com/ShadowOnYOU/images/blob/main/test202311232015113.png?raw=true)

## 5. 电子邮件集成流【作业】

如何与邮件服务器做交互

客户通过发邮件申请一个订单。

3.的实现（单独的程序，是一个web app开发）

上半部分是上节课的内容。

注意要开启qq邮箱的权限，会给你一个授权吗，拷贝到resources

