---
layout: post
title: DevOps——docker容器基础
categories: [cate1, cate2]
description: some word here
keywords: keyword1, keyword2
mermaid: false
sequence: false
flow: false
mathjax: false
mindmap: false
mindmap2: false
---

# DevOps——docker容器基础

## 1. Docker简介

Docker是docker公司开源的一种流行的容器实现方式，极大方便了应用服务部署。

### 用途

1. 提供一次性的环境
2. 提供弹性的云服务
3. 组建微服务架构
   1. docker容器非常轻量。

build once，run anyway

### 优势

1. 环境一致性
   1. docker容器镜像打包了应用服务运行环境
   2. 基于开放标准，可以在任何基础设施上运行
2. 资源独立与隔离
3. 轻量化

### 容器 && 虚拟机

| 虚拟机     | 容器                                                   |                                                            |
| :--------- | :----------------------------------------------------- | ---------------------------------------------------------- |
| 技术原理   | 在物理硬件上运行虚拟化层，创建多个独立的虚拟机         | 利用操作系统级别的虚拟化，隔离应用程序和其依赖的运行环境   |
| 隔离性     | 提供较高的隔离性，每个虚拟机有独立的操作系统和应用软件 | 提供较低的隔离性，容器共享主机操作系统的内核               |
| 资源占用   | 需要较高的资源，每个虚拟机都有自己的虚拟硬件资源       | 需要较低的资源，容器共享主机的操作系统和内核               |
| 启动时间   | 启动时间相对较长，需要启动完整的操作系统和应用程序堆栈 | 启动时间较快，只需启动容器内的应用程序和其依赖的运行环境   |
| 可迁移性   | 可在不同物理服务器上迁移和扩展                         | 可以在不同主机上移植和复制，但依赖于主机操作系统的兼容性   |
| 管理复杂性 | 管理和维护多个虚拟机的操作系统和应用程序堆栈较为复杂   | 管理和维护容器相对简单，使用容器编排工具可以方便地进行管理 |
| 应用场景   | 适用于需要完全隔离和独立的应用程序环境                 | 适用于轻量级应用和微服务架构，快速部署和扩展               |

### 特点

1. 容器是自包含的
2. 容器是可移植的
3. 容器是相互隔离的
4. 容器是轻量级的

## 2. Docker入门

### 基础概念

1. 宿主机（Host Machine）：宿主机是指运行Docker引擎的物理或虚拟计算机系统。宿主机上安装了Docker引擎，它负责管理和运行Docker容器。宿主机提供计算资源和操作系统环境，Docker在其上构建和运行容器。
2. 镜像（Image）：镜像是Docker中的静态文件，它包含了运行容器所需的完整文件系统和应用程序。镜像是构建容器的基础。它可以看作是一个模板或快照，可以用于创建和运行多个相同的容器实例。镜像是只读的，一旦创建就不会被更改。您可以根据现有的镜像创建自定义镜像，也可以从Docker Hub等公共或私有的镜像仓库中获取现成的镜像。
3. 容器（Container）：容器是基于镜像运行的实例。它是一个独立且轻量级的运行环境，包含了应用程序、其依赖项和所需的操作系统。容器可以被创建、启动、停止、删除，并且可以在不同的宿主机之间迁移。容器提供了一种隔离的运行环境，使应用程序能够在独立的沙箱中运行，而不会对宿主机或其他容器产生影响。
4. 仓库（Repository）：仓库是用于存储和组织Docker镜像的地方。它可以是公共的（如Docker Hub）或私有的。仓库允许您上传、下载和分享镜像。在仓库中，镜像被组织成不同的仓库和标签。您可以通过标签来指定镜像的不同版本，例如latest、v1.0等。Docker Hub是一个广泛使用的公共仓库，它提供了大量的官方和社区维护的镜像供用户使用。
5. 关系总结：从景象仓库拉取到容器镜像，使用容器镜像在宿主机上运行容器

### 镜像对象管理

1. 拉取镜像：使用`docker pull`命令从镜像仓库（如Docker Hub）中拉取镜像到本地宿主机。例如，`docker pull nginx`将拉取最新版本的Nginx镜像。
2. 查看镜像：使用`docker images`命令查看本地宿主机上已下载的镜像列表。此命令将显示每个镜像的仓库名称、标签、镜像ID、大小等信息。
3. 构建镜像：使用Dockerfile文件定义一个自定义镜像的构建过程，并使用`docker build`命令在本地宿主机上构建镜像。例如，`docker build -t myimage:tag .`将在当前目录下的Dockerfile中定义的构建过程基础上构建一个名为myimage的镜像。
4. 删除镜像：使用`docker rmi`命令删除本地宿主机上的一个或多个镜像。例如，`docker rmi nginx`将删除名为nginx的镜像。注意，要删除正在使用的镜像，需要先停止和删除相关的容器。
5. 推送镜像：使用`docker push`命令将本地宿主机上的镜像推送到远程镜像仓库。例如，`docker push myimage:tag`将推送名为myimage的镜像到远程仓库。
6. 查找镜像：使用`docker search`命令在镜像仓库中搜索可用的镜像。例如，`docker search mysql`将搜索并显示包含关键字"mysql"的镜像列表。

### Dockerfile

描述镜像是如何构建的脚本

每一条指令都会创建一个镜像层，每多一条指令便会增加一层镜像的大小（这就是为什么我们会使用&&）

dockerfile来构建容器应用运行环境。

docker的配置文件：/etc/docker/daemon。json

## 3. Docker深入

### 架构

采样C/S架构

Client通过接口与Server进程通行实现容器的构建，运行和发布

### 五个部分

DockerServer

DockerDaemon

1. Dockerd
2. cintainerd
3. cintainerd-shim
4. runc

### 基石

1. namespace
2. Cgroups
   1. 是Linux内核提供的对一组进程做系统资源使用限制的机制
3. 

## 4. 忘记写了
