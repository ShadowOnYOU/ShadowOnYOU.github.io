---
layout: post
title: 服务端开发
categories: [cate1, cate2]
description: some word here
keywords: keyword1, keyword2
mermaid: false
sequence: false
flow: false
mathjax: false
mindmap: false
mindmap2: false
---

# 服务端开发——消息中间件

## 1. 复习

## 2. 同步 && 异步

REST API 同步的

异步：A向B发送调用，继续之后的动作，不等待B给出回复

### 消息中间件

有时候，我们没有明确的目标：这边用到broker（消息代理）

A（生产者） - 》 message -〉broker - 》 message -〉 B（消费者）

好处：A和B可以解耦

常用：ActiveMQ，RabbitMQ，kafka

### 例子

Taco Cloud向厨房发送消息

## 3. JMS

java消息服务（java message service）

是一个java标准，定义了使用消息代理的通用API

Spring通过基于模版（JmsTemplate：简化了Jms的代码呈现）的抽象为JMS功能提供了支持

### ActiveMQ Artemis

是一个优秀的跨平台，高性能、开源的消息处理系统

支持协议：JMS，AMOP，MQTT（用的很多，值得关注）

Native内存模式

分布式架构

消息持久化

#### 依赖

spring-boot-starter-artemis

#### 消息体转换器

消息 =》 消息头 + 属性 + 消息体

还可以发对象消息体（这边需要考虑到序列化），之前的是文本消息体

 代码：destination（发到哪里去）topic（主题）

增加新的子模块：JMS

提供功能：提供发消息的功能

#### 主动拉取

#### 主动推送（更快一点，处理更及时）

jmslistener

## 4. RabbitMQ

AMQP（advanced message queueing protocol）

sender -》 RabbiMQ broker -〉 Receiver

broker：exchange -》 binding -〉 queue

消息先发给交换机，然后由于存在很多队列，交换机负责把消息转到某个队列

### routing key && binding key

Routing Key（路由键）是用于消息的路由选择的关键字。当生产者发送消息到消息队列时，它会指定一个Routing Key。消息队列根据这个Routing Key来确定将消息发送到哪些队列。Routing Key可以是任意的字符串，它的格式和含义完全由应用程序自行定义。例如，一个简单的Routing Key可以是一个单词或短语，用于描述消息的内容或目的地。

Binding Key（绑定键）是用于将队列和交换机进行绑定的关键字。在消息队列中，生产者将消息发送到交换机，然后交换机根据Binding Key将消息路由到对应的队列。Binding Key通常与队列的名称或者匹配模式相关联。当队列和交换机进行绑定时，可以指定一个Binding Key或者多个Binding Key。当消息的Routing Key和队列的Binding Key匹配时，消息将被路由到相应的队列。

注意这边还支持通配符

### 依赖

spring-boot-starter-amqp

kafka：做分布式的存储
